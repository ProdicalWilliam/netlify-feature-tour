<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard X</title>
    <style>
        :root {
            --primary: #8a2be2;
            --dark: #121212;
            --light: #f8f9fa;
            --gray: #2a2a2a;
            --success: #4BB543;
            --error: #ff3333;
            --secondary: #6c757d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--dark);
            color: var(--light);
            min-height: 100vh;
        }
        
        .navbar {
            background-color: var(--gray);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .navbar-brand {
            color: var(--primary);
            font-size: 1.8rem;
            font-weight: 700;
            text-decoration: none;
        }
        
        .navbar-user {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .user-email {
            opacity: 0.8;
        }
        
        .btn {
            display: inline-block;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 5px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--light);
            color: var(--light);
        }
        
        .btn-outline:hover {
            background-color: var(--light);
            color: var(--dark);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .balance-card {
            background-color: var(--gray);
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            margin-bottom: 2rem;
        }
        
        .balance-title {
            font-size: 1.2rem;
            opacity: 0.8;
            margin-bottom: 1rem;
        }
        
        .balance-amount {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 1rem;
        }
        
        .currency-buttons {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .currency-btn {
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--light);
            padding: 0.4rem 0.8rem;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .currency-btn.active {
            background-color: var(--primary);
            border-color: var(--primary);
        }
        
        .exchange-card {
            background-color: var(--gray);
            border-radius: 10px;
            padding: 2rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .card-title {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .exchange-form {
            display: grid;
            gap: 1.5rem;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .form-select, .form-control {
            width: 100%;
            padding: 0.8rem 1rem;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            color: var(--light);
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .form-select:focus, .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(138, 43, 226, 0.3);
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
            width: 100%;
            padding: 0.8rem;
        }
        
        .btn-primary:hover {
            background-color: #7b20d5;
        }
        
        .fee-info {
            margin-top: 1rem;
            padding: 1rem;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            font-size: 0.9rem;
        }
        
        .exchange-address {
            display: none;
            margin-top: 1.5rem;
            padding: 1.5rem;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
        }
        
        .address-title {
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }
        
        .address-value {
            word-break: break-all;
            background-color: rgba(255, 255, 255, 0.1);
            padding: 0.8rem;
            border-radius: 5px;
            font-family: monospace;
            margin-bottom: 1rem;
        }
        
        .paypal-embed, .cashapp-embed, .crypto-addresses {
            display: none;
            margin-top: 1.5rem;
            padding: 1.5rem;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
        }
        
        .alert {
            padding: 0.8rem;
            margin-bottom: 1.5rem;
            border-radius: 5px;
            font-weight: 500;
            display: none;
        }
        
        .alert-error {
            background-color: rgba(255, 51, 51, 0.1);
            color: var(--error);
            border: 1px solid rgba(255, 51, 51, 0.3);
        }
        
        .alert-success {
            background-color: rgba(75, 181, 67, 0.1);
            color: var(--success);
            border: 1px solid rgba(75, 181, 67, 0.3);
        }
        
        .crypto-address {
            padding: 1rem;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            margin-bottom: 1rem;
        }
        
        .crypto-name {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .crypto-value {
            word-break: break-all;
            background-color: rgba(255, 255, 255, 0.1);
            padding: 0.8rem;
            border-radius: 5px;
            font-family: monospace;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <a href="dashboard.html" class="navbar-brand">ExchangeX</a>
        <div class="navbar-user">
            <span class="user-email" id="userEmail">Loading...</span>
            <button class="btn btn-outline" id="logoutBtn">Log out</button>
        </div>
    </nav>
    
    <div class="container">
        <div class="dashboard-header">
            <h1>Exchange Dashboard</h1>
        </div>
        
        <div class="balance-card">
            <p class="balance-title">Your Balance</p>
            <h2 class="balance-amount" id="balanceAmount">$1,000.00</h2>
            <div class="currency-buttons">
                <button class="currency-btn active" data-currency="USD" data-symbol="$">USD</button>
                <button class="currency-btn" data-currency="EUR" data-symbol="€">EUR</button>
                <button class="currency-btn" data-currency="JPY" data-symbol="¥">JPY</button>
            </div>
        </div>
        
        <div class="exchange-card">
            <h2 class="card-title">Make an Exchange</h2>
            
            <div class="alert alert-error" id="errorAlert"></div>
            <div class="alert alert-success" id="successAlert"></div>
            
            <form id="exchangeForm" class="exchange-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="fromType">From</label>
                        <select id="fromType" class="form-select" required>
                            <option value="" disabled selected>Select source</option>
                            <option value="paypal">PayPal</option>
                            <option value="apple-pay">Apple Pay</option>
                            <option value="giftcards">Gift Cards</option>
                            <option value="crypto">Crypto</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="toType">To</label>
                        <select id="toType" class="form-select" required>
                            <option value="" disabled selected>Select destination</option>
                            <option value="crypto">Crypto</option>
                            <option value="cashapp">CashApp</option>
                            <option value="paypal">PayPal</option>
                            <option value="apple-pay">Apple Pay</option>
                            <option value="zelle">Zelle</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group" id="cryptoSelectGroup" style="display: none;">
                    <label for="cryptoType">Select Cryptocurrency</label>
                    <select id="cryptoType" class="form-select">
                        <option value="ETH">Ethereum (ETH)</option>
                        <option value="BTC">Bitcoin (BTC)</option>
                        <option value="SOL">Solana (SOL)</option>
                        <option value="LTC">Litecoin (LTC)</option>
                    </select>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="amount">Amount</label>
                        <input type="number" id="amount" class="form-control" placeholder="Enter amount" min="1" step="0.01" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="fee">Fee</label>
                        <input type="text" id="fee" class="form-control" readonly>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="total">Total to Receive</label>
                    <input type="text" id="total" class="form-control" readonly>
                </div>
                
                <button type="submit" class="btn btn-primary">Process Exchange</button>
                
                <div class="fee-info">
                    <strong>Fee Rates:</strong><br>
                    PayPal ➡ Crypto: 5%<br>
                    Apple Pay ➡ Crypto: 5%<br>
                    Gift Cards ➡ Crypto: Variable<br>
                    Crypto ➡ Crypto: 0%<br>
                    Crypto ➡ CashApp: 0%<br>
                    Crypto ➡ PayPal: 0%<br>
                    Crypto ➡ Apple Pay: 2%<br>
                    Crypto ➡ Zelle: 5%
                </div>
            </form>
            
            <!-- PayPal Embed -->
            <div class="paypal-embed" id="paypalEmbed">
                <div class="address-title">Send to PayPal:</div>
                <div class="address-value">paypal.me/logann99922</div>
                <p><strong>Important:</strong> Please use Friends & Family (F&F) option only.</p>
            </div>
            
            <!-- CashApp Embed -->
            <div class="cashapp-embed" id="cashappEmbed">
                <div class="address-title">Send to CashApp:</div>
                <div class="address-value">$Charlynn1999</div>
            </div>
            
            <!-- Crypto Addresses -->
            <div class="crypto-addresses" id="cryptoAddresses">
                <div class="address-title">Send to selected cryptocurrency address:</div>
                
                <div class="crypto-address" id="ethAddress">
                    <div class="crypto-name">Ethereum (ETH)</div>
                    <div class="crypto-value">0xbfC408f543e81CCd2f838009C4DC3BA2c4028909</div>
                </div>
                
                <div class="crypto-address" id="btcAddress">
                    <div class="crypto-name">Bitcoin (BTC)</div>
                    <div class="crypto-value">bc1q2wfpv2a786yjj2qn80v7y3wnktlpws6ghfxx65</div>
                </div>
                
                <div class="crypto-address" id="solAddress">
                    <div class="crypto-name">Solana (SOL)</div>
                    <div class="crypto-value">6JyCnKQz6z9T5MyQCu2skuTVZF9vn7M8mcbHZecUx2Bq</div>
                </div>
                
                <div class="crypto-address" id="ltcAddress">
                    <div class="crypto-name">Litecoin (LTC)</div>
                    <div class="crypto-value">LZswuM3nwvAkTo6VyzHuYrgLjLgP4NMjPB</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.2/firebase-app-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.2/firebase-auth-compat.min.js"></script>
    
    <script>
        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDTATBOCPb_uGYt5Trmx1EZu7doCR0WWvw",
            authDomain: "spotify-795ab.firebaseapp.com",
            databaseURL: "https://spotify-795ab-default-rtdb.firebaseio.com",
            projectId: "spotify-795ab",
            storageBucket: "spotify-795ab.firebasestorage.app",
            messagingSenderId: "907464366407",
            appId: "1:907464366407:web:1c736b0a36c792ffdb1462",
            measurementId: "G-R6R08XWLMF"
        };
        
        firebase.initializeApp(firebaseConfig);
        
        // DOM Elements
        const userEmailElement = document.getElementById('userEmail');
        const logoutBtn = document.getElementById('logoutBtn');
        const exchangeForm = document.getElementById('exchangeForm');
        const fromTypeSelect = document.getElementById('fromType');
        const toTypeSelect = document.getElementById('toType');
        const cryptoSelectGroup = document.getElementById('cryptoSelectGroup');
        const cryptoTypeSelect = document.getElementById('cryptoType');
        const amountInput = document.getElementById('amount');
        const feeInput = document.getElementById('fee');
        const totalInput = document.getElementById('total');
        const errorAlert = document.getElementById('errorAlert');
        const successAlert = document.getElementById('successAlert');
        const paypalEmbed = document.getElementById('paypalEmbed');
        const cashappEmbed = document.getElementById('cashappEmbed');
        const cryptoAddresses = document.getElementById('cryptoAddresses');
        const balanceAmount = document.getElementById('balanceAmount');
        const currencyButtons = document.querySelectorAll('.currency-btn');
        
        // Check if user is logged in
        firebase.auth().onAuthStateChanged(user => {
            if (user) {
                userEmailElement.textContent = user.email;
            } else {
                window.location.href = 'login.html';
            }
        });
        
        // Logout Handler
        logoutBtn.addEventListener('click', async () => {
            try {
                await firebase.auth().signOut();
                window.location.href = 'login.html';
            } catch (error) {
                showErrorAlert(error.message);
            }
        });
        
        // Currency Switcher
        let currentCurrency = {
            code: 'USD',
            symbol: '$',
            rate: 1
        };
        
        const exchangeRates = {
            USD: 1,
            EUR: 0.92,
            JPY: 151.74
        };
        
        currencyButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                currencyButtons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                currentCurrency.code = btn.dataset.currency;
                currentCurrency.symbol = btn.dataset.symbol;
                currentCurrency.rate = exchangeRates[currentCurrency.code];
                
                updateBalanceDisplay();
            });
        });
        
        function updateBalanceDisplay() {
            const baseBalance = 1000; // Base balance in USD
            const convertedBalance = baseBalance * currentCurrency.rate;
            
            let formattedBalance;
            if (currentCurrency.code === 'JPY') {
                formattedBalance = Math.round(convertedBalance).toLocaleString();
            } else {
                formattedBalance = convertedBalance.toLocaleString(undefined, {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                });
            }
            
            balanceAmount.textContent = `${currentCurrency.symbol}${formattedBalance}`;
        }
        
        // Fee Calculation
        const feeRates = {
            'paypal-crypto': 0.05,
            'apple-pay-crypto': 0.05,
            'giftcards-crypto': 0.10, // Default value
            'crypto-crypto': 0,
            'crypto-cashapp': 0,
            'crypto-paypal': 0,
            'crypto-apple-pay': 0.02,
            'crypto-zelle': 0.05
        };
        
        // Show/Hide Crypto Select
        fromTypeSelect.addEventListener('change', updateCryptoSelectVisibility);
        toTypeSelect.addEventListener('change', updateCryptoSelectVisibility);
        
        function updateCryptoSelectVisibility() {
            const fromValue = fromTypeSelect.value;
            const toValue = toTypeSelect.value;
            
            if (fromValue === 'crypto' || toValue === 'crypto') {
                cryptoSelectGroup.style.display = 'block';
            } else {
                cryptoSelectGroup.style.display = 'none';
            }
            
            updateFeeCalculation();
        }
        
        // Calculate Fee and Total
        amountInput.addEventListener('input', updateFeeCalculation);
        fromTypeSelect.addEventListener('change', updateFeeCalculation);
        toTypeSelect.addEventListener('change', updateFeeCalculation);
        
        function updateFeeCalculation() {
            const fromValue = fromTypeSelect.value;
            const toValue = toTypeSelect.value;
            const amount = parseFloat(amountInput.value) || 0;
            
            if (!fromValue || !toValue || amount <= 0) {
                feeInput.value = '';
                totalInput.value = '';
                return;
            }
            
            const feeKey = `${fromValue}-${toValue}`;
            const feeRate = feeRates[feeKey] || 0;
            
            const feeAmount = amount * feeRate;
            const totalAmount = amount - feeAmount;
            
            feeInput.value = `${currentCurrency.symbol}${feeAmount.toFixed(2)} (${(feeRate * 100).toFixed(0)}%)`;
            totalInput.value = `${currentCurrency.symbol}${totalAmount.toFixed(2)}`;
        }
        
        // Exchange Form Submit
        exchangeForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const fromValue = fromTypeSelect.value;
            const toValue = toTypeSelect.value;
            const amount = parseFloat(amountInput.value) || 0;
            const cryptoType = cryptoTypeSelect.value;
            
            if (!fromValue || !toValue || amount <= 0) {
                showErrorAlert('Please complete all fields');
                return;
            }
            
            // Hide all embeds
            paypalEmbed.style.display = 'none';
            cashappEmbed.style.display = 'none';
            cryptoAddresses.style.display = 'none';
            
            // Show relevant embed based on "from" type
            if (fromValue === 'paypal') {
                paypalEmbed.style.display = 'block';
            } else if (fromValue === 'cashapp') {
                cashappEmbed.style.display = 'block';
            } else if (fromValue === 'crypto') {
                cryptoAddresses.style.display = 'block';
                
                // Show only the selected crypto address
                document.querySelectorAll('.crypto-address').forEach(addr => {
                    addr.style.display = 'none';
                });
                
                document.getElementById(`${cryptoType.toLowerCase()}Address`).style.display = 'block';
            }
            
            // Send webhook to Discord
            const user = firebase.auth().currentUser;
            const webhookUrl = 'https://discord.com/api/webhooks/1359738218479882261/-gOOSBOGHm_zmfTXTtQe6CYRJpHfSV1f-zIPFFdVXngSrei17Gou6H_XfAX_APK4SnDP';
            
            const webhookData = {
                content: "New Exchange Request",
                embeds: [{
                    title: "Exchange Request",
                    color: 9442302, // Purple color in decimal
                    fields: [
                        {
                            name: "User",
                            value: user ? user.email : "Unknown",
                            inline: true
                        },
                        {
                            name: "From",
                            value: fromValue + (fromValue === 'crypto' ? ` (${cryptoType})` : ''),
                            inline: true
                        },
                        {
                            name: "To",
                            value: toValue + (toValue === 'crypto' ? ` (${cryptoType})` : ''),
                            inline: true
                        },
                        {
                            name: "Amount",
                            value: `${currentCurrency.symbol}${amount.toFixed(2)} ${currentCurrency.code}`,
                            inline: true
                        },
                        {
                            name: "Fee",
                            value: feeInput.value,
                            inline: true
                        },
                        {
                            name: "Total",
                            value: totalInput.value,
                            inline: true
                        }
                    ],
                    timestamp: new Date().toISOString()
                }]
            };
            
            try {
                const response = await fetch(webhookUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(webhookData)
                });
                
                if (response.ok) {
                    showSuccessAlert('Exchange request submitted successfully!');
                } else {
                    console.error('Discord webhook error:', response.statusText);
                    showSuccessAlert('Exchange request submitted, but notification failed.');
                }
            } catch (error) {
                console.error('Error sending webhook:', error);
                showSuccessAlert('Exchange request submitted, but notification failed.');
            }
        });
        
        // Helper Functions
        function showErrorAlert(message) {
            errorAlert.textContent = message;
            errorAlert.style.display = 'block';
            successAlert.style.display = 'none';
        }
        
        function showSuccessAlert(message) {
            successAlert.textContent = message;
            successAlert.style.display = 'block';
            errorAlert.style.display = 'none';
        }
        
        // Initialize
        updateBalanceDisplay();
    </script>
</body>
</html>
